// Add new YF-1 series engines with RP-1 support by rescaling KCLV YF-20 series models
+PART[KCLV_YF-20_Series_Engine]:BEFORE[RealismOverhaulEngines]
{
    @name = FAK_YF-1
    @title = YF-1
    @mass = 0.5
    @maxTemp = 2000
    %bodyLiftMultiplier = 0.1

    %TechRequired = orbitalRocketry1956
    %cost = 250
    %entryCost = 0
    %RP0conf = true
    %RSSROConfig = True
    %description = The YF-1 is a Chinese liquid rocket engine burning AK27 and UDMH in a gas generator cycle which forms the YF-2 when mounted in a four engine module. It is used on the first stage of the Long March 1.
    @description ^=:$: <b><color=green>From For All Kerbalkind mod</color></b>
    %MODULE[ModuleTagList] { tag = EngineLiquidTurbo }

    @MODULE[ModuleEngines*]
    {
        @name = ModuleEnginesRF
    }

    !MODULE[ModuleEngineConfigs],*{}
    !MODULE[ModuleAlternator],*{}
    !RESOURCE,*{}

    MODULE
    {
        name = ModuleEngineConfigs
        type = ModuleEngines
        configuration = YF-1
        origMass = 0.5
        modded = false
        CONFIG
        {
            name = YF-1
            description = Used on DF-3
            minThrust = 298
            maxThrust = 298
            heatProduction = 100
            massMult = 1.00
            cost = 0
            entryCost = 0
            TechRequired = orbitalRocketry1956
            ullage = True
            pressureFed = False
            ignitions = 1
            ratedBurnTime = 120
            PROPELLANT
			{
				name = UDMH
				ratio = 0.4367
				DrawGauge = True
			}
			PROPELLANT
			{
				name = AK27
			    ratio = 0.5633
			}
            atmosphereCurve
            {
                key = 0 258
                key = 1 239
            }
            IGNITOR_RESOURCE
            {
                name = TEATEB
                amount = 1.0
            }
        }
        CONFIG
        {
            name = YF-1A
            description = Improved version as used on DF-3A, DF-4, and Long March 1
            minThrust = 301
            maxThrust = 301
            heatProduction = 100
            massMult = 1.00
            cost = 10
            entryCost = 0
            TechRequired = orbitalRocketry1958
            ullage = True
            pressureFed = False
            ignitions = 1
            ratedBurnTime = 130
            PROPELLANT
			{
				name = UDMH
				ratio = 0.4367
				DrawGauge = True
			}
			PROPELLANT
			{
				name = AK27
			    ratio = 0.5633
			}
            atmosphereCurve
            {
                key = 0 260
                key = 1 240
            }
            IGNITOR_RESOURCE
            {
                name = TEATEB
                amount = 1.0
            }
            *@PARTUPGRADE[RFUpgrade_YF-1A]/deleteme -= 1
        }
        CONFIG
        {
            name = YF-1B
            description = UDMH/NTO version as used on Long March 1D
            minThrust = 303.6
            maxThrust = 303.6
            heatProduction = 100
            massMult = 1.00
            cost = 20
            entryCost = 0
            TechRequired = orbitalRocketry1960
            ullage = True
            pressureFed = False
            ignitions = 1
            ratedBurnTime = 140
            PROPELLANT
			{
                name = UDMH
                ratio = 0.46
                DrawGauge = True
            }
            PROPELLANT
            {
                name = NTO
                ratio = 0.54
            }
            atmosphereCurve
            {
                key = 0 267.4
                key = 1 242.5
            }
            IGNITOR_RESOURCE
            {
                name = TEATEB
                amount = 1.0
            }
            *@PARTUPGRADE[RFUpgrade_YF-1B]/deleteme -= 1
        }
    }
    RESOURCE
    {
        name = TEATEB
        amount = 1.0
        maxAmount = 1.0
    }
}
PARTUPGRADE
{
    name = RFUpgrade_YF-1A
    partIcon = RO-H1-RS27
    TechRequired = orbitalRocketry1958
    entryCost = 0
    cost = 0      
    title = YF-1 Engine Upgrade: YF-1A Config
    basicInfo = Engine Performance Upgrade
    manufacturer = Engine Upgrade
    deleteme = 1
    description = The YF-1 Engine now supports the YF-1A configuration for increased performance. Unlock it in the VAB/SPH through the engine configs interface.\n\nImproved version as used on DF-3A, DF-4, and Long March 1.
}
PARTUPGRADE
{
    name = RFUpgrade_YF-1B
    partIcon = RO-H1-RS27
    TechRequired = orbitalRocketry1960
    entryCost = 0
    cost = 0      
    title = YF-1 Engine Upgrade: YF-1B Config
    basicInfo = Engine Performance Upgrade
    manufacturer = Engine Upgrade
    deleteme = 1
    description = The YF-1 Engine now supports the YF-1B configuration for increased performance. Unlock it in the VAB/SPH through the engine configs interface.\n\nUDMH/NTO version as used on Long March 1D.
}
+PART[KCLV_YF-21C]:BEFORE[RealismOverhaulEngines]
{
    @name = FAK_YF-2
    @title = YF-2
    @mass = 2
    @maxTemp = 2000
    %bodyLiftMultiplier = 0.1

    %TechRequired = orbitalRocketry1956
    %cost = 1000
    %entryCost = 0
    %RP0conf = true
    %RSSROConfig = True
    %description = The YF-1 is a Chinese liquid rocket engine burning AK27 and UDMH in a gas generator cycle which forms the YF-2 when mounted in a four engine module. It is used on the first stage of the Long March 1.
    @description ^=:$: <b><color=green>From For All Kerbalkind mod</color></b>
    %MODULE[ModuleTagList] { tag = EngineLiquidTurbo }

    @MODULE[ModuleEngines*]
    {
        @name = ModuleEnginesRF
    }

    !MODULE[ModuleEngineConfigs],*{}
    !MODULE[ModuleAlternator],*{}
    !RESOURCE,*{}

    MODULE
    {
        name = ModuleEngineConfigs
        type = ModuleEngines
        configuration = YF-2
        origMass = 2
        modded = false
        CONFIG
        {
            name = YF-2
            description = Used on DF-3
            minThrust = 1192
            maxThrust = 1192
            heatProduction = 100
            massMult = 1.00
            cost = 0
            entryCost = 0
            TechRequired = orbitalRocketry1956
            ullage = True
            pressureFed = False
            ignitions = 1
            ratedBurnTime = 120
            PROPELLANT
			{
				name = UDMH
				ratio = 0.4367
				DrawGauge = True
			}
			PROPELLANT
			{
				name = AK27
			    ratio = 0.5633
			}
            atmosphereCurve
            {
                key = 0 258
                key = 1 239
            }
            IGNITOR_RESOURCE
            {
                name = TEATEB
                amount = 1.0
            }
        }
        CONFIG
        {
            name = YF-2A
            description = Improved version as used on DF-3A, DF-4, and Long March 1
            minThrust = 1204
            maxThrust = 1204
            heatProduction = 100
            massMult = 1.00
            cost = 40
            entryCost = 0
            TechRequired = orbitalRocketry1958
            ullage = True
            pressureFed = False
            ignitions = 1
            ratedBurnTime = 130
            PROPELLANT
			{
				name = UDMH
				ratio = 0.4367
				DrawGauge = True
			}
			PROPELLANT
			{
				name = AK27
			    ratio = 0.5633
			}
            atmosphereCurve
            {
                key = 0 260
                key = 1 240
            }
            IGNITOR_RESOURCE
            {
                name = TEATEB
                amount = 1.0
            }
            *@PARTUPGRADE[RFUpgrade_YF-2A]/deleteme -= 1
        }
        CONFIG
        {
            name = YF-2B
            description = UDMH/NTO version as used on Long March 1D
            minThrust = 1214.4
            maxThrust = 1214.4
            heatProduction = 100
            massMult = 1.00
            cost = 80
            entryCost = 0
            TechRequired = orbitalRocketry1960
            ullage = True
            pressureFed = False
            ignitions = 1
            ratedBurnTime = 140
            PROPELLANT
			{
                name = UDMH
                ratio = 0.46
                DrawGauge = True
            }
            PROPELLANT
            {
                name = NTO
                ratio = 0.54
            }
            atmosphereCurve
            {
                key = 0 267.4
                key = 1 242.5
            }
            IGNITOR_RESOURCE
            {
                name = TEATEB
                amount = 1.0
            }
            *@PARTUPGRADE[RFUpgrade_YF-2B]/deleteme -= 1
        }
    }
    RESOURCE
    {
        name = TEATEB
        amount = 1.0
        maxAmount = 1.0
    }
}
PARTUPGRADE
{
    name = RFUpgrade_YF-2A
    partIcon = RO-H1-RS27
    TechRequired = orbitalRocketry1958
    entryCost = 0
    cost = 0      
    title = YF-2 Engine Upgrade: YF-2A Config
    basicInfo = Engine Performance Upgrade
    manufacturer = Engine Upgrade
    deleteme = 1
    description = The YF-2 Engine now supports the YF-2A configuration for increased performance. Unlock it in the VAB/SPH through the engine configs interface.\n\nImproved version as used on DF-3A, DF-4, and Long March 1.
}
PARTUPGRADE
{
    name = RFUpgrade_YF-2B
    partIcon = RO-H1-RS27
    TechRequired = orbitalRocketry1960
    entryCost = 0
    cost = 0      
    title = YF-2 Engine Upgrade: YF-2B Config
    basicInfo = Engine Performance Upgrade
    manufacturer = Engine Upgrade
    deleteme = 1
    description = The YF-2 Engine now supports the YF-2B configuration for increased performance. Unlock it in the VAB/SPH through the engine configs interface.\n\nUDMH/NTO version as used on Long March 1D.
}
+PART[KCLV_YF22]:BEFORE[RealismOverhaulEngines]
{
    @name = FAK_YF-3
    @title = YF-3
    @mass = 0.625
    @maxTemp = 2000
    %bodyLiftMultiplier = 0.1

    %TechRequired = orbitalRocketry1958
    %cost = 300
    %entryCost = 0
    %RP0conf = true
    %RSSROConfig = True
    %description = The YF-3 is a Chinese liquid rocket engine burning AK27 and UDMH in a gas generator cycle. It is a vacuum optimised version of the YF-1 used on the second stage of the Long March 1.
    @description ^=:$: <b><color=green>From For All Kerbalkind mod</color></b>
    %MODULE[ModuleTagList] { tag = EngineLiquidTurbo }

    @MODULE[ModuleEngines*]
    {
        @name = ModuleEnginesRF
    }

    !MODULE[ModuleEngineConfigs],*{}
    !MODULE[ModuleAlternator],*{}
    !RESOURCE,*{}

    MODULE
    {
        name = ModuleEngineConfigs
        type = ModuleEngines
        configuration = YF-3
        origMass = 0.625
        modded = false
        CONFIG
        {
            name = YF-3
            description = Used on DF-4
            minThrust = 315
            maxThrust = 315
            heatProduction = 100
            massMult = 1.00
            cost = 0
            entryCost = 0
            TechRequired = orbitalRocketry1958
            ullage = True
            pressureFed = False
            ignitions = 1
            ratedBurnTime = 120
            PROPELLANT
			{
				name = UDMH
				ratio = 0.4367
				DrawGauge = True
			}
			PROPELLANT
			{
				name = AK27
			    ratio = 0.5633
			}
            atmosphereCurve
            {
                key = 0 285
                key = 1 219
            }
            IGNITOR_RESOURCE
            {
                name = TEATEB
                amount = 1.0
            }
        }
        CONFIG
        {
            name = YF-3A
            description = Improved version as used on DF-3A, DF-4, and Long March 1
            minThrust = 320.2
            maxThrust = 320.2
            heatProduction = 100
            massMult = 1.00
            cost = 10
            entryCost = 0
            TechRequired = orbitalRocketry1959
            ullage = True
            pressureFed = False
            ignitions = 1
            ratedBurnTime = 130
            PROPELLANT
			{
				name = UDMH
				ratio = 0.4367
				DrawGauge = True
			}
			PROPELLANT
			{
				name = AK27
			    ratio = 0.5633
			}
            atmosphereCurve
            {
                key = 0 286.9
                key = 1 220
            }
            IGNITOR_RESOURCE
            {
                name = TEATEB
                amount = 1.0
            }
            *@PARTUPGRADE[RFUpgrade_YF-3A]/deleteme -= 1
        }
    }
    RESOURCE
    {
        name = TEATEB
        amount = 1.0
        maxAmount = 1.0
    }
}
PARTUPGRADE
{
    name = RFUpgrade_YF-3A
    partIcon = RO-H1-RS27
    TechRequired = orbitalRocketry1959
    entryCost = 0
    cost = 0      
    title = YF-3 Engine Upgrade: YF-3A Config
    basicInfo = Engine Performance Upgrade
    manufacturer = Engine Upgrade
    deleteme = 1
    description = The YF-3 Engine now supports the YF-3A configuration for increased performance. Unlock it in the VAB/SPH through the engine configs interface.\n\nImproved version as used on DF-3A, DF-4, and Long March 1.
}
@ENTRYCOSTMODS:AFTER[RP-0]
{
    YF-1-Derivatives = 40000
    YF-1A-Derivatives = 10000,YF-1-Derivatives
    YF-1B-Derivatives = 20000,YF-1A-Derivatives
    YF-3-Derivatives = 10000,YF-1-Derivatives
}
@ENTRYCOSTMODS:AFTER[xxxRP-0]
{
    FAK-YF-1 = YF-1-Derivatives
    YF-1A = YF-1A-Derivatives
    YF-1B = YF-1B-Derivatives
    FAK-YF-2 = YF-1-Derivatives
    YF-2A = YF-1A-Derivatives
    YF-2B = YF-1B-Derivatives
    FAK-YF-3 = YF-3-Derivatives
    YF-3A = 10000,YF-3-Derivatives
}

@PART[FAK_YF-1]:FOR[Waterfall]
{
    %rescaleFactor = 0.67164
    !EFFECTS {}
    EFFECTS
    {
        running_closed
        {
            AUDIO
            {
                    channel = Ship
                    clip = KIU/KIU_Chinese_Launch_Vehicle_pack/Sounds/config1
                    volume = 0.0 0.0
                    volume = 1.0 1.0
                    pitch = 0.0 1.0
                    pitch = 1.0 1.8
                    loop = true
            }
        }
        engage
        {
            AUDIO
            {
                channel = Ship
                clip = Waterfall/Sounds/KW/sound_liq5
                volume = 0.4
                pitch = 1.0
                loop = false
            }
        }
        disengage
        {
            AUDIO
            {
                channel = Ship
                clip = sound_vent_soft
                volume = 0.4
                pitch = 2.0
                loop = false
            }
        }
        flameout
        {
            AUDIO
            {
                channel = Ship
                clip = sound_explosion_low
                volume = 0.4
                pitch = 2.0
                loop = false
            }
        }
    }
    MODULE
    {
        name = ModuleWaterfallFX
        moduleID = YF20

        CONTROLLER
        {
            name = atmosphereDepth
            linkedTo = atmosphere_density
        }
        CONTROLLER
        {
            name = throttle
            linkedTo = throttle
            engineID = basicEngine
            responseRateUp = 0.02
            responseRateDown = 0.1
        }
        CONTROLLER
        {
            name = random
            linkedTo = random
            range = 0,1
        }

        TEMPLATE
        {
            templateName = waterfall-hypergolic-UDMH-NTO-lower-1 
            overrideParentTransform = thrustTransform
            position = 0,0,0
            rotation = 0, 0, 0
            scale = 0.8, 0.8, 1.8
            @scale[*] *= #$/rescaleFactor$
        }
        TEMPLATE
        {
            templateName = stock-kerolox-generator
            overrideParentTransform = SmokePoint
            position = 0,0,0
            rotation = 0, 0, 0
            scale = 1, 1, 2
            @scale[*] *= #$/rescaleFactor$
        }
    }
}
@PART[FAK_YF-2]:FOR[Waterfall]
{
    %rescaleFactor = 0.67164
    !EFFECTS {}
    EFFECTS
    {
        running_closed
        {
            AUDIO
            {
                channel = Ship
                clip = KIU/KIU_Chinese_Launch_Vehicle_pack/Sounds/config1
                volume = 0.0 0.0
                volume = 1.0 1.0
                pitch = 0.0 1.0
                pitch = 1.0 1.8
                loop = true
            }
        }
        engage
        {
            AUDIO
            {
                channel = Ship
                clip = Waterfall/Sounds/KW/sound_liq5
                volume = 0.4
                pitch = 1.0
                loop = false
            }
        }
        disengage
        {
            AUDIO
            {
                channel = Ship
                clip = sound_vent_soft
                volume = 0.4
                pitch = 2.0
                loop = false
            }
        }
        flameout
        {
            AUDIO
            {
                channel = Ship
                clip = sound_explosion_low
                volume = 0.4
                pitch = 2.0
                loop = false
            }
        }
    }
    MODULE
    {
        name = ModuleWaterfallFX
        moduleID = YF21

        CONTROLLER
        {
            name = atmosphereDepth
            linkedTo = atmosphere_density
        }
        CONTROLLER
        {
            name = throttle
            linkedTo = throttle
            engineID = basicEngine
            responseRateUp = 0.02
            responseRateDown = 0.1
        }
        CONTROLLER
        {
            name = random
            linkedTo = random
            range = 0,1
        }

        TEMPLATE
        {
            templateName = waterfall-hypergolic-UDMH-NTO-lower-1 
            overrideParentTransform = thrustTransform
            position = 0,0,0
            rotation = 0, 0, 0
            scale = 0.9, 0.9, 1.8
            @scale[*] *= #$/rescaleFactor$
        }
        TEMPLATE
        {
            templateName = stock-kerolox-generator
            overrideParentTransform = SmokePoint
            position = 0,0,0
            rotation = -7, 0, 0
            scale = 1, 1, 3
            @scale[*] *= #$/rescaleFactor$
        }
    }
}
@PART[FAK_YF-3]:FOR[Waterfall]
{
    %rescaleFactor = 0.67164
    !EFFECTS {}
    EFFECTS
    {
        fx-spark-running
        {
            AUDIO
            {
                channel = Ship
                clip = Waterfall/Sounds/EnsouSounds/Loop_Liquid_SuperLight_High
                volume = 0.0 0.0
                volume = 1.0 0.4
                pitch = 0.0 1.0
                pitch = 1.0 1.0
                loop = true
            }
        }
        engage
        {
            AUDIO
            {
                channel = Ship
                clip = Waterfall/Sounds/KW/sound_liq5
                volume = 0.4
                pitch = 1.2
                loop = false
            }
        }
        disengage
        {
            AUDIO
            {
                channel = Ship
                clip = sound_vent_soft
                volume = 0.4
                pitch = 2.5
                loop = false
            }
        }
        flameout
        {
            AUDIO
            {
                channel = Ship
                clip = sound_explosion_low
                volume = 0.4
                pitch = 2
                loop = false
            }
        }
    }

    @MODULE[ModuleEngines*]
    {
        //@name = ModuleEnginesFX
        %runningEffectName = fx-spark-running
        !powerEffectName = DELETE
    }

    MODULE
    {
        name = ModuleWaterfallFX
        moduleID = YF22

        CONTROLLER
        {
        name = atmosphereDepth
        linkedTo = atmosphere_density
        }
        
        CONTROLLER
        {
        name = throttle
        linkedTo = throttle
        engineID = basicEngine
        responseRateUp = 0.005
        responseRateDown = 0.1
        }
        CONTROLLER
        {
            name = R1
            linkedTo = random
            noiseType = perlin
            scale = 1.5
            minimum = -1.5
            speed = 12
            seed = 10
        }
        CONTROLLER
        {
            name = R2
            linkedTo = random
            noiseType = perlin
            scale = 1.5
            minimum = -1.5
            speed = 12
            seed = 11
        }
        CONTROLLER
        {
            name = R3
            linkedTo = random
            noiseType = perlin
            scale = 1.5
            minimum = -1.5
            speed = 12
            seed = 12
        }
        CONTROLLER
        {
            name = mach
            linkedTo = mach
        }
        
        TEMPLATE
        {
            templateName = stock-kerolox-sustainer
            overrideParentTransform = thrustTransform
            position = 0,0,0.002
            rotation = 0, 0, 0
            scale = 5, 5, 5
            @scale[*] *= #$/rescaleFactor$
        }
        
        TEMPLATE
        {
            templateName = stock-kerolox-core
            overrideParentTransform = thrustTransform
            position = 0,0,-0.035
            rotation = 0, 0, 0
            scale = 2.1666666667, 2.166666667, 0.355
            @scale[*] *= #$/rescaleFactor$
        }
        
        TEMPLATE
        {
            templateName = stock-kerolox-generator
            overrideParentTransform = thrustTransform
            position = 0.0053, -0.0052, -0.0007
            rotation = 0, 0, 0
            scale = 1.6666667, 1.6666667, 1.6666667
            @scale[*] *= #$/rescaleFactor$
        }
    }
}
